### 详细方案设计
    技术方案选择：轻量级， 简单根据技术适用场景选择
    如 nginx 负载均衡策略：
        1. 轮询（默认）
        2. 加权轮询
        3. ip_hash
        4. fair
        5. url_hash
    备选方案不可行，遗漏某个关键技术点或者关键质量属性
    - 架构师不但要进行备选方案设计和选型，还需要对备选方案的关键细节有较深入的理解
    - 同步分步骤，分阶段，分系统等方式，尽量降低方案复杂度
    - 如果方案本事很复杂，就采用设计团队的方式来进行设计

### 高性能数据库集群： 读写分离

## 读写分离原理
    数据库读写操作分散到不同节点
    - 一主一从或一主多从
    - 数据库主机负责读写操作， 从机只读
    - 同步主机复制数据到从机上

 设计复杂度： 主从复制延迟和分配机制
    - 复制延迟
        解决方案：
        1. 写操作之后的读操作指定发给数据库主服务器
        2. 读从机失败后，再读一次主机
        3. 关键业务读写操作全部指向主机，非关键业务采用读写分离
    - 分配机制
        1. 程序代码封装（淘宝的TDDL: Taobao Distributed Data Layer）
        2. 中间件封装

### 高性能数据库集群： 分库分表
## 分库
    1. 数据量太大，读写性能下降
    2. 数据文件会变的很大，数据库备份和回复需要耗时很长时间
    3. 数据文件越大，极端情况下丢失数据的风险越高

    - 业务分库， 按照业务模块，将数据库分散到不同的数据库服务器
    问题： 
        1. join问题： 数据表分散到不同库上，无法用sql join 查询
        2. 事务问题： 无法统一事务
        3. 成本问题：
    - 综合分析，初创和业务量不大的情况下不建议分库

## 分表
    - 垂直分表： 拆分字段
    - 水平分表： 按行分表
        范围路由：排序，按照时间等作为路由条件， 分配不均问题
        Hash路由：选取某几列hash 运算，根据hash结果，分散到不同的数据库表中
            优点：分配均匀，缺点：扩充新表麻烦，需要重新计算hash值
        配置路由： 独立的表记录路由
    join操作： 业务代码多次join查询合并
    count操作：


